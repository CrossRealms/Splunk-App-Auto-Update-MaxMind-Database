

| makeresults | eval ip="141.236.51.2,7.215.53.162,183.187.186.123,25.28.113.82,163.50.210.27,20.34.145.92,39.139.89.33,21.147.188.76,76.75.62.252,217.88.181.1,205.24.94.176,52.32.198.64,144.63.156.210,181.156.202.35,44.13.164.19,154.35.200.7,100.253.77.165,228.183.54.52,189.38.200.122,52.93.30.219,157.28.202.40,142.16.144.78,143.189.57.57,108.65.148.219,132.250.120.206,188.78.212.169,42.115.198.37,73.49.125.190,183.166.125.169,127.181.63.2,33.235.153.211,103.184.184.115,246.171.127.97,68.100.69.170,126.192.51.152,70.132.168.248,184.228.213.1,208.32.48.92,232.119.245.1,20.27.98.88,178.45.128.156,94.93.239.240,49.228.131.187,129.14.233.221,8.125.139.113,78.51.217.142,53.199.254.231,93.154.50.76,176.22.125.176,143.157.222.196,75.242.107.167,149.35.104.179,253.208.20.70,242.46.75.53,43.202.134.72,110.196.13.110,30.136.116.183,45.227.192.187,153.26.229.84,65.76.135.235,35.54.207.246,148.72.147.236,132.69.222.102,5.252.102.43,153.152.234.48,95.83.45.134,109.28.141.87,183.245.149.11,1.248.195.182,15.139.161.115,52.182.244.117,54.56.78.26,89.42.236.183,251.152.149.41,125.140.147.190,151.183.12.35,173.174.80.143,70.93.90.248,214.86.18.123,223.69.216.158,53.233.86.121,217.74.62.103,246.87.26.53,146.54.41.122,67.199.204.79,153.197.212.144,78.58.229.40,230.136.154.98,173.207.34.10,5.170.72.157,199.141.130.223,219.127.234.50,43.241.14.110,241.108.80.3,218.62.218.1,107.226.70.129,117.63.33.137,32.242.46.124,164.71.69.227,202.158.220.156,85.169.40.118,185.223.244.77,194.204.150.93,80.65.148.86,145.236.152.6,21.161.15.168,57.214.39.123,14.115.82.68,140.45.225.119,250.10.98.240,251.227.129.27,26.151.50.54,111.164.233.29,213.42.237.64,240.196.242.92,213.206.151.25,38.123.224.6,83.48.215.65,17.76.36.200,105.104.74.86,177.54.207.146,212.254.132.25,168.176.207.154,25.43.148.202,140.130.0.122,5.138.173.32,27.176.251.37,51.105.32.90,128.197.7.80,175.13.208.57,225.13.53.157,59.187.152.235,141.170.84.174,235.57.200.186,28.126.4.245,7.68.249.224,35.231.232.113,38.143.90.4,88.46.232.186,213.41.175.87,209.213.24.185,104.170.196.216,69.166.129.249,2.216.222.95,246.122.237.98,224.124.92.41,243.156.41.203,51.203.52.64,61.82.43.250,225.115.125.223,28.190.103.129,97.171.61.56,219.155.143.77,251.130.122.131,164.64.107.8,35.250.120.248,159.172.94.48,251.37.138.142,31.138.218.246,113.140.125.42,40.113.140.140,213.255.59.24,35.138.205.188,107.197.211.59,93.176.52.43,213.131.229.199,150.154.142.61,253.38.13.124,130.189.131.210,172.165.35.166,23.233.96.115,168.246.234.39,117.16.151.148,180.200.160.210,17.3.147.161,193.78.0.201,31.68.129.158,135.123.176.178,37.109.93.47,90.52.61.179,24.40.184.206,3.24.236.130,54.164.94.91,50.171.238.14,192.144.89.137,140.94.194.252,12.233.206.128,10.89.3.21,252.44.97.245,178.29.204.136,188.201.91.229,207.27.181.131,110.30.186.59,161.177.72.1,84.84.247.55,170.122.218.191,110.251.25.33,118.118.167.101,27.52.108.7,182.88.89.182,202.229.24.207,21.134.198.210,76.100.65.38,162.91.239.247,21.237.169.247,107.146.171.184,25.230.180.207,152.182.157.213,30.38.45.62,142.109.32.17,175.141.60.127,127.121.236.189,0.27.181.161,79.190.214.97,233.51.99.77,127.34.73.179,143.118.90.50,132.51.22.232,161.184.59.85,150.115.163.103,175.245.37.48,168.28.171.35,77.19.60.149,145.186.10.233,182.38.68.213,246.88.145.163,61.144.170.251,167.206.116.216,26.109.97.0,231.173.252.180,243.91.194.29,251.108.225.223,47.135.182.79,206.134.180.52,235.47.206.20,255.168.23.180,217.102.37.155,143.128.243.82,162.253.97.232,145.158.109.121,119.60.44.136,169.217.72.158,24.196.51.107,157.37.133.220,217.88.28.185,36.192.218.193,25.38.5.201,86.75.226.215,185.55.141.236,44.71.109.134,47.16.9.116,37.20.38.76,76.61.130.140,84.180.218.123,116.63.196.217,106.64.146.149,179.97.157.90,227.87.84.116,165.62.251.234,39.227.30.195,223.135.28.186,216.88.232.64,18.56.204.43,222.28.162.40,20.231.77.177,33.54.253.215,43.236.230.60,107.229.26.194,228.25.15.72,0.243.119.30,153.226.154.250,2.50.213.54,19.111.245.17,12.132.54.59,82.179.20.154,125.132.194.71,90.230.152.235,106.168.14.155,85.101.130.202,3.165.192.120,93.131.250.22,2.198.176.185,113.67.70.92,165.234.239.172,162.153.126.236,64.26.20.142,203.202.110.82,167.100.192.89,225.123.151.27,177.81.43.238,119.121.82.78,7.170.67.131,245.147.151.10,146.173.210.193,151.40.81.224,69.205.226.128,244.102.34.77,171.210.206.52,123.132.22.72,93.89.163.26,52.197.222.36,124.86.38.43,193.198.217.18,161.104.160.57,20.63.76.233,166.238.196.39,231.162.236.46,223.112.76.158,65.39.222.243,54.158.63.81,208.75.65.79,211.178.76.106,16.162.36.38,155.43.212.176,61.56.167.109,112.147.205.173,24.22.8.171,249.151.137.34,81.58.161.97,177.63.192.51,221.246.218.123,57.51.6.171,154.226.64.252,41.198.125.20,56.146.243.23,98.70.12.230,48.86.174.213,193.25.37.38,167.154.92.173,78.232.120.80,7.126.23.220,205.185.45.8,170.54.250.193,196.50.241.71,130.168.255.217,54.152.88.224,3.107.11.110,105.133.182.184,245.178.217.62,239.220.252.231,110.0.78.232,241.124.62.225,220.68.176.134,69.223.126.209,216.13.38.131,4.135.83.50,123.186.109.78,67.76.192.120,175.36.137.47,51.129.197.191,32.118.11.121,47.174.184.120,82.227.236.186,31.74.44.196,8.115.150.139,241.228.193.205,28.244.31.202,100.255.77.19,137.171.39.227,238.229.138.7,77.74.238.84,80.235.43.230,253.232.93.192,64.168.69.219,54.50.151.22,23.119.44.195,107.116.134.148,242.170.127.29,198.136.42.190,107.217.158.191,51.5.76.89,166.3.149.83,54.225.157.71,233.31.40.243,117.184.69.84,211.39.166.159,173.28.242.23,182.21.29.144,84.69.126.158,38.234.91.137,80.248.208.68,214.67.219.64,77.40.207.151,195.66.112.176,210.46.208.184,178.232.209.71,3.64.22.199,185.230.22.16,79.153.27.234,118.14.239.0,129.221.37.112,10.0.239.251,174.72.88.75,165.231.136.3,196.22.179.159,141.129.195.216,154.246.41.166,211.5.233.136,115.67.148.117,48.144.87.33,112.163.14.102,70.19.94.12,235.94.227.187,159.235.178.101,19.194.4.206,249.165.168.235,96.92.145.20,75.117.113.165,2.152.90.83,138.214.175.134,118.125.31.252,2.8.47.253,3.27.78.238,242.72.203.230,117.143.173.9,148.3.238.39,145.1.166.225,41.54.184.88,241.238.216.147,104.140.89.96,72.146.159.163,245.131.117.171,210.127.132.222,95.230.46.240,178.232.40.126,176.215.180.187,109.66.214.222,162.144.116.254,231.26.0.81,250.235.127.126,122.2.8.207,131.240.144.6,135.19.236.253,119.238.134.230,49.120.253.39,61.101.24.185,220.36.43.160,27.240.193.245,19.118.245.169,22.64.214.61,177.187.35.105,84.41.71.231,101.142.201.0,9.161.58.112,73.236.8.75,149.209.241.171,14.11.49.164,174.212.22.106,182.230.42.44,204.149.47.169,9.82.60.230,217.253.70.56,235.108.166.119,222.252.97.216,135.66.233.101,249.177.69.64,67.81.246.123,130.255.194.112,156.119.218.187,68.95.100.181,87.147.129.31,3.95.106.33,240.74.111.73,140.209.110.255,98.223.152.60,255.165.240.35,120.237.233.203,43.253.141.89,51.244.32.193,160.172.59.113,54.123.47.74,164.249.74.100,242.89.124.193,143.54.5.179,117.86.182.16,215.154.210.91,149.189.196.110,40.221.98.213,235.84.112.172,73.10.129.21,97.83.235.134,245.80.211.186,188.142.142.81,253.187.243.104,50.187.178.231,17.200.117.189,139.89.93.80,124.189.119.204,236.162.122.54,153.166.0.19,79.94.78.116,33.213.101.238,176.252.139.188,210.37.90.134,41.212.248.150,156.150.220.206,35.117.73.44,60.148.17.6,1.224.191.99,78.41.155.149"
| makemv ip delim="," | mvexpand ip 
| collect index=main sourcetype="random:ips"

index=main sourcetype="random:ips"


=> Without doing anything

index=main sourcetype="random:ips" | iplocation ip | table ip, City, Region, Country | collect index=main sourcetype="iplocation:test:without:anything"


=> Installed it and tested the below search to make sure currently no IP is giving wrong location.

| makeresults | eval ip="<all-ips>"
| makemv ip delim="," | mvexpand ip 
| iplocation ip
| rename City as City1, Region as Region1, Country as Country1
| append [| search index=main sourcetype="iplocation:test:without:anything"  | rename City as City2, Region as Region2, Country as Country2]
| stats first(City*) as City*, first(Region*) as Region*, first(Country*) as Country* by ip
| where City1!=City2 OR Region1!=Region2 OR Country1!=Country2




=> Add ip location lookup to maxminddb-App/lookups folder

index=main sourcetype="random:ips" | iplocation ip | table ip, City, Region, Country | collect index=main sourcetype="iplocation:test:from:maxminddb:lookup"

=> Diff checker search

index=main sourcetype="iplocation:test:without:anything" | rename City as City1, Region as Region1, Country as Country1
| append [| search index=main sourcetype="iplocation:test:from:maxminddb:lookup" | rename City as City2, Region as Region2, Country as Country2]
| stats first(City*) as City*, first(Region*) as Region*, first(Country*) as Country* by ip
| where City1!=City2 OR Region1!=Region2 OR Country1!=Country2




=> Add ip location lookup to search-App/lookups folder

index=main sourcetype="random:ips" | iplocation ip | table ip, City, Region, Country | collect index=main sourcetype="iplocation:test:from:search:lookup"

=> Diff checker search

index=main sourcetype="iplocation:test:without:anything" | rename City as City1, Region as Region1, Country as Country1
| append [| search index=main sourcetype="iplocation:test:from:search:lookup" | rename City as City2, Region as Region2, Country as Country2]
| stats first(City*) as City*, first(Region*) as Region*, first(Country*) as Country* by ip
| where City1!=City2 OR Region1!=Region2 OR Country1!=Country2


